{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#Clase 2 Eco Aplicada"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###I. Enfoque de utilidad directa\n",
    "    1. CPO\n",
    "    2. Slutsky\n",
    "    3. Condición de Agregación\n",
    "    4. Homogeneidad"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###II. Enfoque de Utilidad indirecta\n",
    "    1. Identidad de Roy"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### III. Enfoque de costos (Lema de Shepherd)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###Efectos cruzados\n",
    "\n",
    "$$\\frac{\\delta x}{\\delta w} = \\frac{\\delta x}{\\delta w}|_{dU = 0} + (T-l)\\frac{\\delta x}{\\delta y}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{\\delta l}{\\delta p} = \\frac{\\delta l}{\\delta p}|_{dU = 0} + x\\frac{\\delta l}{\\delta y}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$Px-(T-l)w = y$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### *Condiciones de agregación"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Supuestos: En no saciedad siempre estamos consumiendo sobre restricción presupuestal."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Diferenciando totalmente a $y$:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$P\\frac{\\delta x}{\\delta y} + w\\frac{\\delta l}{\\delta y} = 1$$ (Condición de agregación de Engel)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$P\\frac{\\delta x}{\\delta y}\\frac{ y}{ y}\\frac{ x}{ x} + w\\frac{\\delta l}{\\delta y}\\frac{ l}{ l}\\frac{ y}{ y} = 1$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{Px}{y}\\frac{ \\delta x}{\\delta y}\\frac{ y}{ x} + \\frac{ wl}{ y}\\frac{ \\delta w}{ \\delta y}\\frac{ y}{ w} = 1$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[23'] $$\\frac{ Px}{y} \\epsilon_{xy} + \\frac{wl}{y}\\epsilon_{ly} = 1$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Diferenciando totalmente: P, w (Condición de Cournot)\n",
    "    $$P\\frac{\\delta x}{\\delta y} + w\\frac{\\delta l}{\\delta P}+x = 0$$\n",
    "    $$P\\frac{\\delta x}{\\delta w} + w\\frac{\\delta l}{\\delta w}-[T-l] = 0$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###Homogeneidad"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Las demandas $x^*$ y $l^*$ son homogéneas de grado cero. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Definición matemática: En general, se dice $g(x)$ es homogénea de grado $k$ si: [25]\n",
    "$$ g(tx) = t^k g(x)$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Dif[25]: t [26]\n",
    "    $$\\sum g_i x_i = k t^{k-1} g(x),$$\n",
    "    donde $g_i = \\frac{\\delta g}{\\delta x_i}$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Si g(·) es homogénea de grado cero,\n",
    "$$\\sum g_i z_i =0$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Aplicando restricción de Marshall,\n",
    "$$x(tP, tw, ty) = t^k x(p,w,y)$$\n",
    "sabemos que $x^*$ es de grado cero por CPO"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[27]$$P\\frac{\\delta x}{\\delta P} + w\\frac{\\delta x}{\\delta w}+y\\frac{\\delta x}{\\delta y} = 0$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Sust Slutsky:\n",
    "   $$ P\\frac{\\delta x}{\\delta P}|_{dU = 0} +w\\frac{\\delta x}{\\delta w}|_{dU = 0}+\\frac{\\delta x}{\\delta y}[y-px+w(T-l)]$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " $$ \\Longrightarrow P\\frac{\\delta x}{\\delta P}|_{dU = 0} +w\\frac{\\delta x}{\\delta w}|_{dU = 0}=0$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[28(Por supuesto)]:\n",
    "    $$w\\frac{\\delta l}{\\delta w}|_{dU = 0} +P\\frac{\\delta l}{\\delta P}|_{dU = 0}=0$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##Caso 2 bienes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Sabemos que $\\frac{\\delta x}{\\delta P}|_{dU = 0} < 0$ y $\\frac{\\delta l}{\\delta w}|_{dU = 0} < 0$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Entonces, de [28]:\n",
    "    cuando n=2 bienes $\\Longrightarrow$ son bienes sustitutos.\n",
    "    $\\frac{\\delta x}{\\delta w}|_{dU = 0} \\geq 0$ y $\\frac{\\delta l}{\\delta P}|_{dU = 0} \\geq 0$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##II. Enfoque de utilidad indirecta\n",
    "[9] $l^* = l(P, w, y,A, \\epsilon)$\n",
    "\n",
    "[10] $x^* = x(P, w, y,A, \\epsilon)$\n",
    "\n",
    "$$U(x^*, l^*) = U[x^*(P, w, y,A, \\epsilon), l^*(P, w, y,A, \\epsilon)] = V[P, w, y, A, \\epsilon]$$\n",
    "\n",
    "es el valor monetario de mi felicidad cuando [30] consumo mi canasta óptima. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##Efecto de un $\\Delta$ en el ingreso:\n",
    "$$\\frac{\\delta V}{\\delta y} = \\frac{\\delta U}{\\delta x^*}\\frac{\\delta x^*}{\\delta y} + \\frac{\\delta U}{\\delta l^*}\\frac{\\delta l^*}{\\delta y}$$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Sabemos que $U_x = \\lambda P$ & $U_l = \\lambda w$ "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\Longrightarrow -\\frac{\\delta V}{\\delta y} = P\\frac{\\delta x^*}{\\delta y} + w\\frac{\\delta l^*}{\\delta y}, $$\n",
    "\n",
    "por condición de Engel"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[31]$$ \\Longrightarrow \\frac{\\delta V}{\\delta y} = \\lambda > 0$$\n",
    "$$ \\lambda = \\frac{U_x}{P}>0,$$ por la condición de no saciedad."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##Efecto de un $\\Delta$ en precio:\n",
    "$$\\frac{\\delta V}{\\delta P} = U^*_x\\frac{\\delta x^*}{\\delta P} + U^*_l\\frac{\\delta l^*}{\\delta P}, $$ por condiciones de Cournot."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{\\delta V}{\\delta P}  = \\lambda\\Bigg[\\frac{\\delta x^*}{\\delta P}P + \\frac{\\delta l^*}{\\delta P}w\\Bigg], $$ por CPO"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[32]$$\\frac{\\delta V}{\\delta P}  = -\\lambda_{+} x_{+} \\leq 0$$ "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Por otro lado,\n",
    "$$\\frac{\\delta V}{\\delta w} = U^*_x\\frac{\\delta x}{\\delta W} + U^*_l\\frac{\\delta l^*}{\\delta W}, (CPO) $$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{\\delta V}{\\delta P}  = \\lambda\\Bigg[P\\frac{\\delta x}{\\delta w} + w\\frac{\\delta l}{\\delta w}\\Bigg]$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Diferenciando totalmente: P, w, condición de Cournot\n",
    "    $$P\\frac{\\delta x}{\\delta P} + w\\frac{\\delta l}{\\delta P} + x = 0$$\n",
    "    $$P\\frac{\\delta x}{\\delta w} + w\\frac{\\delta l}{\\delta w} - (T-l) = 0$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{\\delta V}{\\delta w} = \\lambda (T-l)$$\n",
    "$$ \\frac{\\delta V}{\\delta w} = \\lambda h^* \\geq 0, [33]$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##Identidad de Roy"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{\\frac{\\delta V}{\\delta P}}{\\frac{\\delta V}{\\delta y}} = \\frac{-\\lambda x}{\\lambda} = -x^*(P,w,y, \\epsilon, A)$$\n",
    "\n",
    "obtengo demandas Marshallianas."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\frac{\\frac{\\delta V}{\\delta w}}{\\frac{\\delta V}{\\delta y}} = \\frac{\\lambda h}{\\lambda} = h^*[T-l^*(P,w,y, \\epsilon, A)]$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##Enfoque: función de costos/gasto"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Aquí va gráfica2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##Problema de minimización"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\mathscr{L}= c(P, w, A, \\epsilon) + \\mu [U_0-U(x,l;A,\\epsilon)]$$\n",
    "$$\\mathscr{L}= Px-w(T-l) + \\mu [U_0-U(x,l;A,\\epsilon)]$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###FOC:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\mathscr{L}_{x}: P-\\mu U_x =0$$\n",
    "$$\\mathscr{L}_{l}: w-\\mu U_l =0$$\n",
    "$$\\mathscr{L}_{\\mu}: U_0- U(x,l,A,\\epsilon) =0$$\n",
    "    [36]\n",
    "    $$\\Longrightarrow TMS = \\frac{w}{P} = \\frac{U_l}{U_x},$$\n",
    "    $$U_0 = U[x,l, A, \\epsilon]$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "De [36] podemos sacar TMS y con $U_0 = U(x,l,A,\\epsilon)$ podemos sacar las demandas Hicksianas."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$x^* = x(P,w,U_0)$$\n",
    "$$l^* = l(P,w,U_0)$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Aquí va gráfica 3"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En el óptimo, la función de gasto no es sino el valor monetario que debo tener para alcanzar una $U = U_0$, dados $P, w, y$. Es decir, $C[P,w, U_0(P,w,y)]= y$ [39]. Diferenciando [39] respecto a $y$,\n",
    "\n",
    "$$\\frac{\\delta C}{\\delta U_0}\\frac{\\delta U_0}{\\delta y} = 1 \\Longrightarrow 1 = c_3\\frac{\\delta U_0}{\\delta y} \\Longrightarrow 1 = c_3 \\lambda \\Longrightarrow c_3 = \\frac{1}{\\lambda}, [40]$$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Derivando [39] con P,\n",
    "$$0 = c_1 + c_3\\frac{\\delta U_0}{\\delta P}$$\n",
    "$$0 = c_1 + \\frac{1}{\\lambda}\\frac{\\delta U_0}{\\delta P} = c_1 +\\frac{\\frac{\\delta U_0}{\\delta P}}{\\frac{\\delta U_0}{\\delta y}} = c_1 -x(P,w, U_0) \\Longrightarrow c_1 = x(P,W, U_0)$$ \n",
    "[Lema de Shepherd]\n",
    "$$\\Longrightarrow \\frac{\\delta c^*}{\\delta P} = x^*(P,w, U_0) [Demanda_{Hicksiana}], $$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "De la misma forma, \n",
    "$$\\frac{\\delta c}{\\delta w} = -[T-l(P,w, U_0)] = -h $$\n",
    "De forma general, \n",
    "$$\\frac{\\delta c}{\\delta P_i} = x_i|_{dU=0}$$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "i) Minimización de función de gasto (si la invertimos, obtenemos la función de utilidad(Rubalcava dice que nomás querremos sustituir. Es decir, sustituímos $U_0$ de la función de utilidad indirecta en $U_0$ de la función de demanda compensada o Hicksiana. Análogamente para el caso de la función de gasto a la Marshalliana))\n",
    "Función de gasto\n",
    "$$c(U_0, w, P) = y $$\n",
    "$$\\Longrightarrow \\frac{\\delta c_i}{\\delta P_i}, [Shepherd]$$\n",
    "Con lo anterior obtenemos la demanda compensada o de Hicks:\n",
    "$$x_i^* = x(U_0, P, w)$$\n",
    "ii) Función de utilidad indirecta:\n",
    "$$V(y, w, P) = U_0$$\n",
    "$$\\Longrightarrow \\frac{\\frac{\\delta V}{\\delta P}}{\\frac{\\delta V}{\\delta y}}, [Roy]$$\n",
    "Mediante la anterior identidad de Roy podremos llegar a la demanda Marshalliana,\n",
    "$$x^*_i = x_i(y,P, w).$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Aquí va la gráfica 4."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
